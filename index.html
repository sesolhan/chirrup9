<!doctype html>
<html lang="ko">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>chirrup9</title>
<link rel="preconnect" href="https://cdn.jsdelivr.net" crossorigin>
<style>
  @font-face {
    font-family: 'JoseonGulim';
    src: url('https://cdn.jsdelivr.net/gh/projectnoonnu/noonfonts_20-04@1.0/ChosunGu.woff') format('woff');
    font-weight: 400;
    font-style: normal;
    font-display: swap;
  }
  :root{
    --bg:#e6e6e6; --panel:#e6e6e6; --card:#b9dcfe; --fg:#111827; --muted:#6b7280; --line:#cfd4dc;
    --font-sans:'JoseonGulim',-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,'Apple SD Gothic Neo','Noto Sans KR',sans-serif;
    --chip-border:#6b7280;
    --accent:#54dd22;
  }
  *{box-sizing:border-box}
  html, body {
    height:100%;
    background:var(--bg); /* 1. 배경색 꽉차게 */
    overscroll-behavior:none; /* 2. 반동 제거 */
  }
  body{
    margin:0;
    color:var(--fg);
    font-family:var(--font-sans);
    overflow-x:hidden;
    background:var(--bg); /* 1. 배경색 꽉차게 */
  }
  .stage{
    width:100vw; max-width:none; margin:0; padding:0;
    display:grid; gap:0;
    grid-template-columns:minmax(360px,560px) 1fr; 
    align-items:start;
    background:var(--bg); /* 1. 배경색 꽉차게 */
  }
  .left{
    background:var(--panel);
    padding:30px;
    min-height:100vh;
    position:relative;
  }
  .about-link{
    font-weight:700; font-size:18px; cursor:pointer; transition:.15s;
    border-bottom:2px solid transparent; display:inline-block; margin-bottom:18px;
  }
  .about-link:hover, .about-link:focus{
    border-bottom-color:#111827;
    text-decoration:none;
  }
  /* 3. 오른쪽 미디어 영역: 데스크톱만 보임, 모바일은 숨김 */
  .right{
    background:#54dd22;
    color:#fff;
    min-height:100vh;
    display:flex; align-items:center; justify-content:center;
    position:sticky; top:0;
  }
  .right .placeholder{opacity:.7; letter-spacing:.02em}
  @media (max-width:900px){
    .stage{grid-template-columns:1fr;}
    .right{display:none !important;} /* 3. 모바일에서 숨김 */
    body.modal-open{overflow:hidden;} /* 모달 열릴 때 배경 스크롤 금지 */
  }
  /* 4. 코끼리 이모지 항상 우측 하단 */
  .fab-elephant{
    position:fixed;right:24px;bottom:24px;width:130px;height:130px;
    background:transparent;border:none;box-shadow:none;border-radius:0;
    display:flex;align-items:center;justify-content:center;
    font-size:120px; line-height:1; cursor:pointer; z-index:3000;
    -webkit-tap-highlight-color:transparent; transition:transform .18s ease;
  }
  .fab-elephant:hover{ transform:scale(1.04); }
  @media (max-width:900px){ .fab-elephant{ width:90px;height:90px;font-size:90px;right:16px;bottom:16px } }
  /* 모바일 미디어 모달 */
  #mediaModal{
    display:none; position:fixed; inset:0; z-index:4000;
    background:rgba(0,0,0,.38); align-items:center; justify-content:center;
    padding:18px;
  }
  #mediaModal.open{ display:flex; }
  .media-modal-content{
    background:#fff; border-radius:18px; max-width:96vw; width:100%; max-height:90vh; overflow:auto;
    box-shadow:0 4px 32px rgba(0,0,0,.18);
    position:relative;
    display:flex; flex-direction:column; align-items:center; justify-content:center;
  }
  .media-modal-close{
    position:absolute; top:10px; right:14px; font-size:28px; background:transparent; border:none; color:#222; cursor:pointer; z-index:10;
  }
</style>
</head>
<body>
  <main class="stage">
    <section class="left">
      <span id="aboutBtn" class="about-link" tabindex="0">About</span>
      <div class="stories" id="storyBar"></div>
      <div id="list"></div>
    </section>
    <aside class="right" id="media"><div class="placeholder">‧₊˚.⋆·ฺ.∗̥✩⁺˚✩‧₊˚ੈ*:ﾟ*｡.⋆·ฺᐝ.∗̥⁺˚</div></aside>
  </main>
  <!-- 4. 코끼리 이모지 플로팅 -->
  <button class="fab-elephant" id="gbFab" aria-label="Guestbook">🐘</button>
  <!-- 3. 모바일 미디어 모달 -->
  <div id="mediaModal" aria-modal="true" role="dialog">
    <div class="media-modal-content" id="mediaModalContent">
      <button class="media-modal-close" id="mediaModalClose" aria-label="닫기">×</button>
      <div id="mediaModalInner"></div>
    </div>
  </div>
<script>
const isMobile = () => window.matchMedia('(max-width:900px)').matches;
const $media = document.getElementById('media');
const $mediaModal = document.getElementById('mediaModal');
const $mediaModalContent = document.getElementById('mediaModalContent');
const $mediaModalInner = document.getElementById('mediaModalInner');
const $mediaModalClose = document.getElementById('mediaModalClose');

/* 2. 스크롤 반동 완전 제거 */
document.body.addEventListener('touchmove', function(e){
  if(document.body.classList.contains('modal-open')) e.preventDefault();
}, {passive:false});

/* 3. 카드 클릭 시 모바일은 모달로 미디어 표시 */
function showMedia($article){
  let mediaArr = [];
  try { mediaArr = JSON.parse($article.getAttribute('data-media')||"[]"); }
  catch { mediaArr = []; }
  if(!mediaArr.length){
    if(isMobile()){
      openMediaModal('<div style="padding:40px;text-align:center;color:#888;font-size:22px;">미디어 없음</div>');
    }else{
      $media.innerHTML = `<div class="placeholder">‧₊˚.⋆·ฺ.∗̥✩⁺˚✩‧₊˚ੈ*:ﾟ*｡.⋆·ฺᐝ.∗̥⁺˚</div>`;
    }
    return;
  }
  let idx = 0;
  function renderSlide(i){
    const urlRaw = mediaArr[i];
    let html = "";
    // ...미디어 렌더링 로직 동일...
    html = `<img src="${urlRaw}" style="max-width:100%;height:auto;display:block" />`;
    // 실제 구현에서는 이미지/영상/유튜브/드라이브 등 분기 필요
    if(isMobile()){
      openMediaModal(`
        <div class="media-slider">
          <div class="media-slide">${html}</div>
          <div class="media-indicator">
            ${mediaArr.map((_,j)=>`<span class="media-dot${j===i?' active':''}" data-idx="${j}"></span>`).join("")}
          </div>
          ${mediaArr.length>1 ? `
            <button class="media-nav prev" ${i===0?'disabled':''} aria-label="이전">&#10094;</button>
            <button class="media-nav next" ${i===mediaArr.length-1?'disabled':''} aria-label="다음">&#10095;</button>
          ` : ''}
        </div>
      `);
      $mediaModalInner.querySelectorAll('.media-dot').forEach(dot=>{
        dot.onclick = ()=>{ idx = Number(dot.getAttribute('data-idx')); renderSlide(idx); };
      });
      $mediaModalInner.querySelector('.media-nav.prev')?.addEventListener('click', ()=>{ if(idx>0){ idx--; renderSlide(idx); } });
      $mediaModalInner.querySelector('.media-nav.next')?.addEventListener('click', ()=>{ if(idx<mediaArr.length-1){ idx++; renderSlide(idx); } });
    }else{
      $media.innerHTML = `
        <div class="media-slider">
          <div class="media-slide">${html}</div>
          <div class="media-indicator">
            ${mediaArr.map((_,j)=>`<span class="media-dot${j===i?' active':''}" data-idx="${j}"></span>`).join("")}
          </div>
          ${mediaArr.length>1 ? `
            <button class="media-nav prev" ${i===0?'disabled':''} aria-label="이전">&#10094;</button>
            <button class="media-nav next" ${i===mediaArr.length-1?'disabled':''} aria-label="다음">&#10095;</button>
          ` : ''}
        </div>
      `;
      $media.querySelectorAll('.media-dot').forEach(dot=>{
        dot.onclick = ()=>{ idx = Number(dot.getAttribute('data-idx')); renderSlide(idx); };
      });
      $media.querySelector('.media-nav.prev')?.addEventListener('click', ()=>{ if(idx>0){ idx--; renderSlide(idx); } });
      $media.querySelector('.media-nav.next')?.addEventListener('click', ()=>{ if(idx<mediaArr.length-1){ idx++; renderSlide(idx); } });
    }
  }
  renderSlide(idx);
}
function openMediaModal(html){
  $mediaModalInner.innerHTML = html;
  $mediaModal.classList.add('open');
  document.body.classList.add('modal-open');
}
function closeMediaModal(){
  $mediaModal.classList.remove('open');
  document.body.classList.remove('modal-open');
  $mediaModalInner.innerHTML = '';
}
$mediaModalClose.addEventListener('click', closeMediaModal);
$mediaModal.addEventListener('click', e=>{
  if(e.target === $mediaModal) closeMediaModal();
});
document.addEventListener('keydown', e=>{
  if(e.key === 'Escape' && $mediaModal.classList.contains('open')) closeMediaModal();
});

/* 카드 클릭 이벤트 연결 예시 */
document.addEventListener('click', e=>{
  const card = e.target.closest('article.card');
  if(card) showMedia(card);
});
</script>
</body>
</html>
